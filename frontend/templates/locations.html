{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Přehled dostupných skladů</h2>
    
    <!-- Tlačítko pro otevření Modalu -->
    {% if session.get('active_company_id') %}
    <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createLocationModal">
        + Vytvořit nový sklad
    </button>
    {% endif %}
</div>

<!-- Mřížka se sklady -->
<div class="row">
    {% for loc in locations %}
    <div class="col-md-4 mb-3">
        <div class="card h-100 shadow-sm border-0">
            <div class="card-body">
                <div class="d-flex align-items-center mb-2">
                    <div class="bg-primary text-white rounded p-2 me-3">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-box-seam" viewBox="0 0 16 16">
                            <path d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5l2.404.961L10.404 2zm3.564 1.426L5.596 5 8 5.961 14.154 3.5zm3.25 1.7-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/>
                        </svg>
                    </div>
                    <h5 class="card-title mb-0">{{ loc.name }}</h5>
                </div>
                <p class="card-text text-muted">
                    {{ loc.description if loc.description else "Žádný popis není k dispozici." }}
                </p>
            </div>
            <div class="card-footer bg-transparent border-top-0 pb-3">
                <a href="{{ url_for('location_detail', location_id=loc.id) }}" class="btn btn-outline-primary btn-sm w-100">
    Otevřít sklad
</a>
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-12 text-center py-5">
        <p class="text-muted">Zatím nebyly vytvořeny žádné sklady nebo k nim nemáte přístup.</p>
        {% if not session.get('active_company_id') %}
            <div class="alert alert-warning d-inline-block">
                Pro zobrazení nebo vytváření skladů musíte nejprve vybrat firmu v horním menu.
            </div>
        {% endif %}
    </div>
    {% endfor %}
</div>

<!-- Bootstrap Modal pro vytvoření skladu -->
<div class="modal fade" id="createLocationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form action="{{ url_for('create_location') }}" method="POST">
                <div class="modal-header">
                    <h5 class="modal-title">Nový sklad / lokace</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Název skladu</label>
                        <input type="text" name="name" class="form-control" placeholder="Např. Centrální sklad, Auto č. 1..." required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Popis (volitelně)</label>
                        <textarea name="description" class="form-control" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zrušit</button>
                    <button type="submit" class="btn btn-primary">Vytvořit sklad</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}